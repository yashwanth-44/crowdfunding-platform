# Environment Variables Configuration

Copy this file to `.env` in the backend directory and fill in your actual values.

## Database Configuration
```
# PostgreSQL Connection String
# Format: postgresql://username:password@host:port/database?schema=public
DATABASE_URL="postgresql://user:password@postgres:5432/crowdfunding?schema=public"
```

## JWT Configuration
```
# Secret keys for JWT signing (use strong random values in production)
JWT_SECRET="your-super-secret-jwt-key-change-in-production"
JWT_REFRESH_SECRET="your-super-secret-refresh-key-change-in-production"

# Token expiration times
JWT_EXPIRY="15m"                          # Access token lifetime
JWT_REFRESH_EXPIRY="7d"                   # Refresh token lifetime
```

## Stripe Payment Configuration
```
# Get these from your Stripe Dashboard: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY="sk_test_..."           # Secret key (test mode)
STRIPE_PUBLISHABLE_KEY="pk_test_..."      # Publishable key (test mode)
STRIPE_WEBHOOK_SECRET="whsec_..."         # Webhook signing secret
```

## Redis Cache Configuration
```
# Redis Connection String
REDIS_URL="redis://redis:6379"
```

## AWS S3 / MinIO Configuration
```
# S3 Bucket Information
S3_BUCKET="crowdfunding-bucket"           # Bucket name
S3_REGION="us-east-1"                     # AWS region

# MinIO (for local development)
S3_ENDPOINT="http://minio:9000"           # MinIO endpoint
S3_ACCESS_KEY="minioadmin"                # MinIO access key
S3_SECRET_KEY="minioadmin"                # MinIO secret key
S3_USE_PATH_STYLE_URL="true"              # Use path-style URLs for MinIO

# For AWS S3 (production):
# S3_ENDPOINT="https://s3.amazonaws.com"
# S3_ACCESS_KEY="your-aws-access-key"
# S3_SECRET_KEY="your-aws-secret-key"
# S3_USE_PATH_STYLE_URL="false"
```

## Server Configuration
```
# Server port
PORT=3001

# Node environment
NODE_ENV="development"                    # development, staging, or production

# Allowed origins for CORS
ALLOWED_ORIGINS="http://localhost:3000,http://localhost:3001"

# Logging
LOG_LEVEL="debug"                         # debug, info, warn, error
```

## Email Service Configuration (Optional)
```
# SMTP Server for email notifications
SMTP_HOST="smtp.gmail.com"
SMTP_PORT="587"
SMTP_USER="your-email@gmail.com"
SMTP_PASS="your-app-password"             # Use app-specific password for Gmail

# For other providers, adjust SMTP_HOST accordingly
# Gmail: smtp.gmail.com:587
# Outlook: smtp-mail.outlook.com:587
# Mailgun: smtp.mailgun.org:587
```

## Rate Limiting Configuration
```
# Rate limit window duration in milliseconds
RATE_LIMIT_WINDOW_MS="900000"             # 15 minutes

# Maximum requests per window
RATE_LIMIT_MAX_REQUESTS="100"             # 100 requests per 15 minutes
```

## Production Settings

### For AWS Deployment
```
NODE_ENV="production"
ALLOWED_ORIGINS="https://yourdomain.com,https://api.yourdomain.com"
S3_ENDPOINT="https://s3.amazonaws.com"
S3_REGION="us-east-1"
STRIPE_SECRET_KEY="sk_live_..."           # Live mode key
LOG_LEVEL="info"
```

### For Digital Ocean / Linode
```
DATABASE_URL="postgresql://user:pass@postgres.provider.com:5432/db"
REDIS_URL="redis://:password@redis.provider.com:6379"
```

### For Heroku
```
DATABASE_URL="${DATABASE_URL}"            # Auto-provided by Heroku
NODE_ENV="production"
PORT="${PORT}"                            # Auto-provided by Heroku
REDIS_URL="${REDIS_URL}"                  # Heroku Redis
```

## Development Credentials (Local Testing Only)

```
# Test user accounts (created by seed.ts)

# Admin
EMAIL=admin@crowdfunding.com
PASSWORD=Admin@123

# Campaign Creator
EMAIL=creator@example.com
PASSWORD=Creator@123

# Lender
EMAIL=lender@example.com
PASSWORD=Lender@123

# Borrower
EMAIL=borrower@example.com
PASSWORD=Borrower@123
```

## Security Notes

⚠️ **IMPORTANT**: 

1. **Never commit `.env` file to version control**
2. **Use strong, random values for JWT secrets in production**
3. **Rotate secrets regularly**
4. **Use environment-specific variables**
5. **Store sensitive keys in secret management tools:**
   - AWS Secrets Manager
   - Azure Key Vault
   - HashiCorp Vault
   - Kubernetes Secrets

## Environment-Specific Configurations

### Development (.env.local)
```
NODE_ENV="development"
LOG_LEVEL="debug"
ALLOWED_ORIGINS="http://localhost:3000,http://localhost:3001"
```

### Staging (.env.staging)
```
NODE_ENV="staging"
LOG_LEVEL="info"
ALLOWED_ORIGINS="https://staging.yourdomain.com"
```

### Production (.env.production)
```
NODE_ENV="production"
LOG_LEVEL="info"
ALLOWED_ORIGINS="https://yourdomain.com"
PORT="443"
```

## Validation

Run this command to validate your environment setup:

```bash
npm run validate:env
```

This will check:
- ✅ All required variables are set
- ✅ Format of URLs and keys
- ✅ Connectivity to external services
- ✅ Permission and access validations
